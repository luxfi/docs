"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5580],{80690:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>t,metadata:()=>r,toc:()=>l});var i=s(85893),o=s(11151);const t={tags:["Luxd APIs"],description:"This page is an overview of the Auth API associated with Luxd.",sidebar_label:"Auth API",pagination_label:"Auth API"},a="Auth API",r={id:"reference/luxd/auth-api",title:"Auth API",description:"This page is an overview of the Auth API associated with Luxd.",source:"@site/docs/reference/luxd/auth-api.md",sourceDirName:"reference/luxd",slug:"/reference/luxd/auth-api",permalink:"/reference/luxd/auth-api",draft:!1,unlisted:!1,editUrl:"https://github.com/luxdefi/docs/edit/main/docs/reference/luxd/auth-api.md",tags:[{label:"Luxd APIs",permalink:"/tags/luxd-ap-is"}],version:"current",frontMatter:{tags:["Luxd APIs"],description:"This page is an overview of the Auth API associated with Luxd.",sidebar_label:"Auth API",pagination_label:"Auth API"},sidebar:"reference",previous:{title:"Admin API",permalink:"/reference/luxd/admin-api"},next:{title:"Health API",permalink:"/reference/luxd/health-api"}},d={},l=[{value:"Format",id:"format",level:2},{value:"Endpoint",id:"endpoint",level:2},{value:"Methods",id:"methods",level:2},{value:"<code>auth.newToken</code>",id:"authnewtoken",level:3},{value:"<code>auth.revokeToken</code>",id:"authrevoketoken",level:3},{value:"<code>auth.changePassword</code>",id:"authchangepassword",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"auth-api",children:"Auth API"}),"\n",(0,i.jsx)(n.p,{children:"When you run a node, you can require that API calls have an authorization token attached. This API\nmanages the creation and revocation of authorization tokens."}),"\n",(0,i.jsx)(n.p,{children:"An authorization token provides access to one or more API endpoints. This is useful for\ndelegating access to a node\u2019s APIs. Tokens expire after 12 hours."}),"\n",(0,i.jsxs)(n.p,{children:["An authorization token is provided in the header of an API call. Specifically, the header\n",(0,i.jsx)(n.code,{children:"Authorization"})," should have value ",(0,i.jsx)(n.code,{children:"Bearer TOKEN.GOES.HERE"})," (where ",(0,i.jsx)(n.code,{children:"TOKEN.GOES.HERE"})," is replaced with\nthe token)."]}),"\n",(0,i.jsxs)(n.p,{children:["This API is only reachable if the node is started with ",(0,i.jsx)(n.a,{href:"/nodes/configure/luxd-config-flags",children:"config flag"}),(0,i.jsx)(n.code,{children:"--api-auth-required"}),". If the node is\nstarted without this CLI, API calls do not require authorization tokens, so this API is not\nreachable. This API never requires an authorization token to be reached."]}),"\n",(0,i.jsxs)(n.p,{children:["Authorization token creation must be permissioned. If you run your node with ",(0,i.jsx)(n.code,{children:"--api-auth-required"}),",\nyou must also specify the file to read the Auth API's password from, with argument\n",(0,i.jsx)(n.code,{children:"--api-auth-password-file"}),". You must provide this password in order to create/revoke authorization\ntokens."]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["If you run your node with ",(0,i.jsx)(n.code,{children:"--api-auth-required"})," then some tools like Core or MetaMask may not be\nable to make API calls to your node because they don\u2019t have an auth token."]}),(0,i.jsxs)(n.p,{children:["This API set is for a specific node, it is unavailable on the ",(0,i.jsx)(n.a,{href:"/tooling/rpc-providers",children:"public server"}),"."]})]}),"\n",(0,i.jsx)(n.h2,{id:"format",children:"Format"}),"\n",(0,i.jsxs)(n.p,{children:["This API uses the ",(0,i.jsx)(n.code,{children:"json 2.0"})," RPC format. For more information on making JSON RPC calls, see\n",(0,i.jsx)(n.a,{href:"/reference/standards/guides/issuing-api-calls",children:"here."})]}),"\n",(0,i.jsx)(n.h2,{id:"endpoint",children:"Endpoint"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"/ext/auth\n"})}),"\n",(0,i.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(n.h3,{id:"authnewtoken",children:(0,i.jsx)(n.code,{children:"auth.newToken"})}),"\n",(0,i.jsx)(n.p,{children:"Creates a new authorization token that grants access to one or more API endpoints."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Signature:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"auth.newToken(\n    {\n        password: string,\n        endpoints: []string\n    }\n) -> {token: string}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"password"})," is this node\u2019s authorization token password."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"endpoints"})," is a list of endpoints that will be accessible using the generated token. If\n",(0,i.jsx)(n.code,{children:"endpoints"})," contains an element ",(0,i.jsx)(n.code,{children:'"*"'}),", the generated token can access any API endpoint."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"token"})," is the authorization token."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Call:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'curl -X POST --data \'{\n    "jsonrpc": "2.0",\n    "method": "auth.newToken",\n    "params":{\n        "password":"YOUR PASSWORD GOES HERE",\n        "endpoints":["/ext/bc/X", "/ext/info"]\n    },\n    "id": 1\n}\' -H \'content-type:application/json;\' 127.0.0.1:9650/ext/auth\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This call will generate an authorization token that allows access to API endpoints ",(0,i.jsx)(n.code,{children:"/ext/bc/X"}),"\n(that is the X-Chain) and ",(0,i.jsx)(n.code,{children:"/ext/info"})," (that is the ",(0,i.jsx)(n.a,{href:"/reference/luxd/info-api",children:"info API"}),".)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "result": {\n    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbmRwb2ludHMiOlsiKiJdLCJleHAiOjE1OTM0NzU4OTR9.Cqo7TraN_CFN13q3ae4GRJCMgd8ZOlQwBzyC29M6Aps"\n  },\n  "id": 1\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This authorization token should be included in API calls by giving header ",(0,i.jsx)(n.code,{children:"Authorization"})," value\n",(0,i.jsx)(n.code,{children:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbmRwb2ludHMiOlsiKiJdLCJleHAiOjE1OTM0NzU4OTR9.Cqo7TraN_CFN13q3ae4GRJCMgd8ZOlQwBzyC29M6Aps"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, to call ",(0,i.jsx)(n.a,{href:"/reference/luxd/info-api#infopeers",children:(0,i.jsx)(n.code,{children:"info.peers"})})," with this token:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'curl -X POST --data \'{\n    "jsonrpc":"2.0",\n    "id"     :1,\n    "method" :"info.peers"\n}\' 127.0.0.1:9650/ext/info \\\n-H \'content-type:application/json;\' \\\n-H \'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbmRwb2ludHMiOlsiKiJdLCJleHAiOjE1OTM0NzU4OTR9.Cqo7TraN_CFN13q3ae4GRJCMgd8ZOlQwBzyC29M6Aps\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"authrevoketoken",children:(0,i.jsx)(n.code,{children:"auth.revokeToken"})}),"\n",(0,i.jsx)(n.p,{children:"Revoke a previously generated token. The given token will no longer grant access to any endpoint. If\nthe token is invalid, does nothing."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Signature:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"auth.revokeToken(\n    {\n        password: string,\n        token: string\n    }\n) -> {}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"password"})," is this node\u2019s authorization token password."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"token"})," is the authorization token being revoked."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Call:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'curl -X POST --data \'{\n    "jsonrpc": "2.0",\n    "method": "auth.revokeToken",\n    "params":{\n        "password":"123",\n        "token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1OTMxNzIzMjh9.qZVNhH6AMQ_LpbXnPbTFEL6Vm5EM5FLU-VEKpYBH3k4"\n    },\n    "id": 1\n}\' -H \'content-type:application/json;\' 127.0.0.1:9650/ext/auth\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "result": {},\n  "id": 1\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"authchangepassword",children:(0,i.jsx)(n.code,{children:"auth.changePassword"})}),"\n",(0,i.jsx)(n.p,{children:"Change this node\u2019s authorization token password. Any authorization tokens created under an old\npassword will become invalid."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Signature:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"auth.changePassword(\n    {\n        oldPassword: string,\n        newPassword: string\n    }\n) -> {}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"oldPassword"})," is this node\u2019s current authorization token password."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"newPassword"})," is the node\u2019s new authorization token password after this API call. Must be between\n1 and 1024 characters."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Call:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'curl -X POST --data \'{\n    "jsonrpc": "2.0",\n    "method": "auth.changePassword",\n    "params":{\n        "oldPassword":"OLD PASSWORD HERE",\n        "newPassword":"NEW PASSWORD HERE"\n    },\n    "id": 1\n}\' -H \'content-type:application/json;\' 127.0.0.1:9650/ext/auth\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "result": {},\n  "id": 1\n}\n'})})]})}function c(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},11151:(e,n,s)=>{s.d(n,{Z:()=>r,a:()=>a});var i=s(67294);const o={},t=i.createContext(o);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);